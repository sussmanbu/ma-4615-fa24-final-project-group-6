<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Here we provide a detailed analysis using more sophisticated statistics techniques.">

<title>MA 415 Final Project Group 6 - Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">MA 415 Final Project Group 6</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./big_picture.html"> 
<span class="menu-text">Big Picture</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./analysis.html" aria-current="page"> 
<span class="menu-text">Analysis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./data.html"> 
<span class="menu-text">Data</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#understanding-the-influence-of-socioeconomic-status-and-social-determinants-a-comprehensive-analysis-of-race-state-level-variations-and-health-outcomes" id="toc-understanding-the-influence-of-socioeconomic-status-and-social-determinants-a-comprehensive-analysis-of-race-state-level-variations-and-health-outcomes" class="nav-link active" data-scroll-target="#understanding-the-influence-of-socioeconomic-status-and-social-determinants-a-comprehensive-analysis-of-race-state-level-variations-and-health-outcomes">Understanding the Influence of Socioeconomic Status and Social Determinants: A Comprehensive Analysis of Race, State-Level Variations, and Health Outcomes</a>
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#motivation-behind-data-analysis" id="toc-motivation-behind-data-analysis" class="nav-link" data-scroll-target="#motivation-behind-data-analysis">Motivation Behind Data Analysis</a></li>
  <li><a href="#data-findings" id="toc-data-findings" class="nav-link" data-scroll-target="#data-findings">Data Findings</a>
  <ul class="collapse">
  <li><a href="#racial-disparities-in-health-mental-and-physical-status" id="toc-racial-disparities-in-health-mental-and-physical-status" class="nav-link" data-scroll-target="#racial-disparities-in-health-mental-and-physical-status">Racial Disparities in Health (mental and physical status)</a></li>
  <li><a href="#education-and-loneliness-level" id="toc-education-and-loneliness-level" class="nav-link" data-scroll-target="#education-and-loneliness-level">Education and Loneliness Level</a></li>
  <li><a href="#socioeconomic-variations-across-states-on-mental-health" id="toc-socioeconomic-variations-across-states-on-mental-health" class="nav-link" data-scroll-target="#socioeconomic-variations-across-states-on-mental-health">Socioeconomic Variations across States on Mental Health</a></li>
  <li><a href="#health-status-and-affordability-of-medical-costs" id="toc-health-status-and-affordability-of-medical-costs" class="nav-link" data-scroll-target="#health-status-and-affordability-of-medical-costs">Health Status and Affordability of Medical Costs</a></li>
  <li><a href="#past-exposure-and-current-consumption-on-physical-health" id="toc-past-exposure-and-current-consumption-on-physical-health" class="nav-link" data-scroll-target="#past-exposure-and-current-consumption-on-physical-health">Past Exposure and Current Consumption on Physical Health</a></li>
  </ul></li>
  <li><a href="#limitations" id="toc-limitations" class="nav-link" data-scroll-target="#limitations">Limitations:</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Analysis</h1>
</div>

<div>
  <div class="description">
    Here we provide a detailed analysis using more sophisticated statistics techniques.
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><img src="images/analysis_page.png" class="img-fluid"></p>
<section id="understanding-the-influence-of-socioeconomic-status-and-social-determinants-a-comprehensive-analysis-of-race-state-level-variations-and-health-outcomes" class="level1">
<h1>Understanding the Influence of Socioeconomic Status and Social Determinants: A Comprehensive Analysis of Race, State-Level Variations, and Health Outcomes</h1>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Physical and mental health outcomes are deeply influenced by a combination of factors, including the environment, access to health insurance, socioeconomic status, and lived experiences. These elements work together to shape people’s overall well-being, and current habits, and determine the opportunities and challenges individuals face in maintaining good health.</p>
</section>
<section id="motivation-behind-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="motivation-behind-data-analysis">Motivation Behind Data Analysis</h2>
<p>Driven by the desire to uncover the consistent patterns underlying disparities and inequities in physical and mental health, this analysis aims to explore the critical connections between socioeconomic status, social determinants, and their direct correlation with health outcomes. By analyzing various contributing factors, it seeks to identify the potential causes behind the differing patterns in physical and mental health. By analyzing these factors, this analysis aims to provide evidence-based insights that can inform policy decisions, promote equitable healthcare, and ultimately contribute to a more just society. The proposed thesis is that socioeconomic status and social determinants directly correlate to mental and physical health outcomes, with variations across states and race. The variables of interest are from the following categorizations:&nbsp;</p>
<ul>
<li><p>The Identity-Based Category including State, Education level, and Race.</p></li>
<li><p>The Economic Category including medical cost, insurance status, income, ability to pay monthly bills.</p></li>
<li><p>The Health Category including Physical Health, Mental Health, Loneliness, Satisfaction of Life.</p></li>
<li><p>The Past Exposure Category including variables about answers for did you live with anyone who was depressed, mentally ill, or suicidal? Problem drinker or alcoholic? Or used illegal street drugs or who abused prescription medications?</p></li>
<li><p>The Current Behaviors Category including variables about marijuana using and Alcohol drinks per days.</p></li>
</ul>
<p>Some questions that are explored include: How are education rates and loneliness rates related? Can we accurately predict the relationship between health status and affording medical costs? Does childhood exposure to negative social experiences affect current behavior? How does mental and physical health vary across different racial groups?</p>
</section>
<section id="data-findings" class="level2">
<h2 class="anchored" data-anchor-id="data-findings">Data Findings</h2>
<section id="racial-disparities-in-health-mental-and-physical-status" class="level3">
<h3 class="anchored" data-anchor-id="racial-disparities-in-health-mental-and-physical-status">Racial Disparities in Health (mental and physical status)</h3>
<p><img src="images/Race_health.png" class="img-fluid"></p>
<p>Race is a critical factor influencing disparities in mental health outcomes, serving as a lens through which broader socioeconomic inequities and social determinants manifest. The graph illustrates significant racial disparities in mental health outcomes, as measured by the average number of days individuals felt mentally unwell last month.&nbsp;</p>
<p>The data suggests that groups with historically limited access to economic resources and healthcare—such as Multiracial individuals, American Indians, and Pacific Islanders—report poorer mental health, with an average close to or higher than 5 days of distress, compared to others. These patterns may possibly be due to the intersection of systemic inequities, such as economic instability, discrimination, and lack of healthcare access, which disproportionately affect certain racial groups. Conversely, groups with comparatively better access to resources and also with the highest average reported income (primarily in the income category $50,000 to &lt; $100,000), such as Asians and Whites, report fewer days of mental health distress, with an average fewer than 3.5 days.</p>
<p><img src="images/race_physical.png" class="img-fluid"></p>
<p>Similarly, the same trend holds for physical health outcomes as well. As the above bar graph demonstrates, physical health outcomes, as measured in the number of days the respondents felt unwell physically, also display racial disparities. Instead of the multiracial groups, American Indian or Pacific Natives (with an average of 4.4 days) now face the worst physical health outcomes. However, the top 3 racial groups that face the worst physical health outcomes are still those who face the worst mental health distress: Multiracial individuals, Native Americans, and Pacific Islanders. On the other hand, Asian, Black, and White individuals all have averages lower than 3 days. They experience better physical health than the other racial groups, which is consistent with their mental health outcomes. This parallel further highlights the disparity across social determinants and socioeconomic status among races, which leads to disparities in health outcomes.</p>
</section>
<section id="education-and-loneliness-level" class="level3">
<h3 class="anchored" data-anchor-id="education-and-loneliness-level">Education and Loneliness Level</h3>
<p><img src="images/education_loneliness.png" class="img-fluid">Education is a significant indicator for socioeconomic status, so it is used to investigate the specific link between socioeconomic status and health outcomes. Across all racial groups, the percentage of survey respondents reporting feelings of loneliness tends to decrease as education level increases. Since loneliness is a key predictor of mental health, a Poisson regression model is used to investigate the relationship between state income and loneliness on the number of days of mental health unwell last month. The predictor state income has undergone log transformations to correct the skewness. The variable loneliness has been filtered to keep only responses “Alway,” “Usually,” “Rarely,” and “Never.” Then, it is transformed into a binary variable. The coefficient for log(state GDP) is 1.861682, which shows that the predicted number of days with poor mental health per month is 543.45% higher for individuals who feel lonely compared to those who do not. Additionally, there are state-level variations: people living in wealthier states have 1.61% more predicted days of poor mental health per month than those in less affluent states with a coefficient of 0.015956. These results are all statistically significant.</p>
<p>These findings suggest that socioeconomic factors, such as education level, directly correlate with mental health through their impact on loneliness. This relationship is likely because respondents with higher education levels often report higher incomes and better life satisfaction, which are associated with lower levels of loneliness and, in turn, better mental health outcomes.</p>
</section>
<section id="socioeconomic-variations-across-states-on-mental-health" class="level3">
<h3 class="anchored" data-anchor-id="socioeconomic-variations-across-states-on-mental-health">Socioeconomic Variations across States on Mental Health</h3>
<p><img src="images/ratio_state_income_updated.png" class="img-fluid"></p>
<p>There is a significantly moderate positive correlation (0.31) between the average personal income of a state and the diversity ratio of the state. This means that as a state becomes more diverse, the average personal income of the state increases, suggesting that diversity leads to better economic outcomes for each state. There is also a significantly positive correlation between the average personal income of a state and the average days that mental health is unwell. This means that as a state’s income increases, the average days that mental health is unwell for the population of that state also increases. Though this relationship is significant, it is important to consider that the range for average days that mental health is unwell per state ranges from about 3 to 5 days.&nbsp;</p>
<p>Overall, this data suggests that the diversity ratio of a state increases average personal income, which then increases the average days that mental health is unwell. Placing this information into a larger cultural context, this is more confirmation that higher diversity leads to higher income, as more diversity often leads to a greater variety of opinions and ideas that can lead to more innovation and therefore more economic growth. It is also understandable that the increase of personal income could cause larger stress in life, possibly related to maintaining the income to sustain the higher-income lifestyle created,&nbsp; which would lead to more days of decreased mental health.&nbsp;</p>
</section>
<section id="health-status-and-affordability-of-medical-costs" class="level3">
<h3 class="anchored" data-anchor-id="health-status-and-affordability-of-medical-costs">Health Status and Affordability of Medical Costs</h3>
<p><img src="images/medical_cost_health.png" class="img-fluid"></p>
<p>Based on the correlation analysis of medical costs, health status, and insurance status, we observe how socioeconomic factors influence health outcomes. A moderate positive correlation between medical costs and insurance status (0.2607) suggests that having insurance might lead to higher reported medical costs, likely due to better access to healthcare services. The positive correlation between health status and medical costs (0.1413) further indicates that while better health could reduce medical expenses.</p>
<p>Building on this, we developed a logistic regression model to predict the affordability of medical costs based on health status. The model reveals that as health status improves, the predicted probability of affording medical costs increases. The coefficient for health status in the regression model is 0.56291, indicating that a one-unit increase in health status leads to a significant increase in the log-odds of affording medical costs. By converting this coefficient to a percentage change, we find that a better health status corresponds to a 75.58% higher likelihood of being able to afford medical costs.</p>
<p>The plot clearly illustrates this trend, with the red line showing the relationship between health status and predicted affordability, while the blue points represent individual predictions. It reveals that individuals with poorer health are less likely to afford medical costs, whereas those in better health are more likely to do so. This supports our thesis that better health status correlates with better access to healthcare resources, emphasizing the impact of social determinants on individuals’ ability to manage medical expenses and their overall well-being.</p>
</section>
<section id="past-exposure-and-current-consumption-on-physical-health" class="level3">
<h3 class="anchored" data-anchor-id="past-exposure-and-current-consumption-on-physical-health">Past Exposure and Current Consumption on Physical Health</h3>
<p><img src="images/exposure_consumption.png" class="img-fluid"> Respondents were asked to report the number of days they used marijuana over the past 30 days. The box plot illustrates the distribution of marijuana usage frequencies based on childhood exposure to specific conditions or behaviors. The y-axis represents the number of days marijuana was used in a 30-day period, while the x-axis indicates binary exposure levels: “Yes” for respondents who were exposed to a specific condition or behavior during childhood, and “No” for those who were not.</p>
<p>Mean values are represented by the red dots present in the images. The mean marijuana frequency across all exposure types is larger for respondents who indicated that they were exposed. For example, for alcohol exposure, the mean is 14.59 days for respondents who were not exposed and 16.43 days for respondents who were exposed. Median values show a similar pattern, with higher medians among respondents exposed to a condition or behavior. For example, the median for those not exposed to depression is 10, compared to 20 for those exposed. Participants who were exposed to various adverse childhood experiences are susceptible to higher usage for marijuana.</p>
<p>An ANOVA test was performed to assess whether the differences in results between the “Yes” and “No” options were statistically significant. There is a highly significant effect (p &lt; 0.001) of exposure level on marijuana usage, meaning that if an individual is exposed to these conditions in childhood, they are more likely to show differences in marijuana usage frequency. Exposure type alone does not significantly influence marijuana usage, but exposure level is a strong predictor. Additionally, there is no significant interaction between exposure type and exposure level. This suggests that exposure to conditions in childhood has a significant effect on their marijuana usage, regardless of the specific type of exposure.&nbsp;</p>
<p>Thus, we emphasize that exposure to adverse behaviors during childhood has a significant likelihood of shaping current behavioral patterns, particularly concerning health and the impact of exposure to relatively unhealthy conditions. The results underline the importance of addressing and mitigating harmful exposures during childhood to reduce the likelihood of adverse health behaviors later in life.</p>
<p><strong><em>Current Consumption on Physical Health</em></strong></p>
<p>To examine the relationship between marijuana consumption and physical health, a logistic regression model was employed to assess how marijuana consumption frequency and the inability to pay bills impact physical health status. The variable inability to pay bills was included as a fixed effect as it is shown previously that socioeconomic status can be a significant factor for health status. Physical health status, which was a categorical variable, was transformed into a binary variable, with “1” representing poor health. The regression analysis reveals the coefficient for marijuana to be 0.041412, which indicates that a one-unit increase in marijuana consumption is associated with a 4.23% increase in the likelihood of experiencing poor health. Additionally, financial status plays a significant role: individuals unable to afford monthly bills, such as rent, are 169.16% more likely to report poor health compared to those who can afford their bills, with a coefficient of 0.990144. These findings underscore that, beyond medical costs, other financial stress and one’s personal behaviors are strongly directly correlated with health outcomes, whereas their current behavior is influenced by past exposures. Overall, the results highlight the broader link between socioeconomic status and social determinants with physical health.</p>
</section>
</section>
<section id="limitations" class="level2">
<h2 class="anchored" data-anchor-id="limitations">Limitations:</h2>
<ul>
<li><p>As with all research regarding surveys, there is always a potential for biased and inaccurate responses. For example, for variables such as PHYSHLTH and MENTHLTH, people might over or under report the days they felt unwell physically or mentally.</p></li>
<li><p>There was an exclusion of two states and 12 territories which does not give a complete understanding of these variables across the whole U.S. population, although the data is quite comprehensive.</p></li>
<li><p>The lack of proxy interviews restricts data collection from individuals with disabilities who need guardians to report on their behalf, as well as from those without phones. Furthermore, the absence of TTY services or accommodations for individuals who are deaf or hard of hearing may result in the exclusion of these populations.</p></li>
<li><p>For the regression analysis, some data was filtered out to build a binary variable, which may result in the loss of valuable insights and fail to represent the entire dataset. Additionally, the models did not include many predictors, which could lead to an overestimation of the coefficients.</p></li>
<li><p>The marijuana use and adverse childhood exposure plot relied on binary data, without details on the depth or frequency of exposure, making it impossible to quantify how much exposure leads to these effects.</p></li>
</ul>
<hr>
<p><strong>Attributions</strong></p>
<p><a href="https://r4ds.hadley.nz/" class="uri">https://r4ds.hadley.nz/</a></p>
<p><a href="https://stats.oarc.ucla.edu/r/dae/poisson-regression/" class="uri">https://stats.oarc.ucla.edu/r/dae/poisson-regression/</a></p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/sussmanbu\.github\.io\/ma-4615-fa24-final-project-group-6\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>